name: portnox-radius-basic-cloud

# Basic 802.1X RADIUS Lab with Portnox Cloud RADIUS
# This lab demonstrates basic 802.1X authentication pointing to Portnox Cloud RADIUS
# Configure your switch to point to your Portnox Cloud RADIUS IP and ports

topology:
  nodes:
    # Cisco Switch configured to use Portnox Cloud RADIUS
    cisco-switch-cloud:
      kind: ceos
      image: ceos:latest
      mgmt-ipv4: 172.20.20.20
      startup-config: |
        hostname cisco-sw-cloud
        !
        aaa new-model
        aaa authentication dot1x default group radius
        aaa authorization network default group radius
        !
        ! IMPORTANT: Replace with your Portnox Cloud RADIUS IP and ports
        ! Get these from: Portnox Cloud Console > Settings > RADIUS Gateways
        radius server PORTNOX-CLOUD
         address ipv4 YOUR_PORTNOX_CLOUD_IP auth-port YOUR_AUTH_PORT acct-port YOUR_ACCT_PORT
         key YOUR_RADIUS_SECRET
        !
        dot1x system-auth-control
        !
        interface Ethernet1
         description Management
         no shutdown
        !
        interface Ethernet2
         description 802.1X Client Port
         switchport mode access
         switchport access vlan 10
         authentication port-control auto
         dot1x pae authenticator
         spanning-tree portfast
         no shutdown
        !
        interface Ethernet3
         description 802.1X Client Port 2
         switchport mode access
         switchport access vlan 10
         authentication port-control auto
         dot1x pae authenticator
         spanning-tree portfast
         no shutdown
        !
        vlan 10
         name Authenticated-VLAN
        !
    
    # Arista Switch configured to use Portnox Cloud RADIUS
    arista-switch-cloud:
      kind: ceos
      image: ceos:latest
      mgmt-ipv4: 172.20.20.21
      startup-config: |
        hostname arista-sw-cloud
        !
        aaa authentication dot1x default group radius
        aaa authorization network default group radius
        !
        ! IMPORTANT: Replace with your Portnox Cloud RADIUS IP and ports
        radius-server host YOUR_PORTNOX_CLOUD_IP auth-port YOUR_AUTH_PORT acct-port YOUR_ACCT_PORT key YOUR_RADIUS_SECRET
        !
        dot1x system-auth-control
        !
        interface Ethernet1
         description Management
         no shutdown
        !
        interface Ethernet2
         description 802.1X Client Port
         switchport mode access
         switchport access vlan 10
         dot1x pae authenticator
         dot1x authentication failure action traffic allow vlan 999
         spanning-tree portfast
         no shutdown
        !
        vlan 10
         name Authenticated-VLAN
        !
        vlan 999
         name Guest-VLAN
        !
    
    # Linux Client with wpa_supplicant (EAP-PEAP)
    client-peap:
      kind: linux
      image: wbitt/network-multitool:latest
      mgmt-ipv4: 172.20.20.30
      exec:
        - apt-get update && apt-get install -y wpasupplicant
      binds:
        - /data/configs/wpa_supplicant:/configs:ro
    
    # Linux Client with wpa_supplicant (EAP-TLS)
    client-tls:
      kind: linux
      image: wbitt/network-multitool:latest
      mgmt-ipv4: 172.20.20.31
      exec:
        - apt-get update && apt-get install -y wpasupplicant
      binds:
        - /data/configs/wpa_supplicant:/configs:ro
        - /data/configs/ca:/certs:ro

  links:
    - endpoints: ["cisco-switch-cloud:eth2", "client-peap:eth1"]
    - endpoints: ["arista-switch-cloud:eth2", "client-tls:eth1"]
